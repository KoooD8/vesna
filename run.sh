#!/bin/bash

set -euo pipefail

echo "ü§ñ –ó–∞–ø—É—Å–∫ AI Agents Stack"

# –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
if [ -d "venv" ]; then
  # shellcheck disable=SC1091
  source venv/bin/activate
elif [ -d ".venv" ]; then
  # shellcheck disable=SC1091
  source .venv/bin/activate
else
  echo "‚ö†Ô∏è  –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ. –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –±–µ–∑ –Ω–µ–≥–æ..."
fi

# –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ, –µ—Å–ª–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
if ! python3 -c 'import requests, bs4, yaml' 2>/dev/null; then
  echo "‚ÑπÔ∏è  –ü–æ—Ö–æ–∂–µ, –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã. –ó–∞–ø—É—Å—Ç–∏—Ç—å ./setup.sh —Å–µ–π—á–∞—Å? [Y/n]"
  read -r ans
  if [ -z "${ans:-}" ] || [[ "$ans" =~ ^[Yy]$ ]]; then
    if [ -x "./setup.sh" ]; then
      ./setup.sh
    else
      echo "‚ùå –ù–µ –Ω–∞–π–¥–µ–Ω setup.sh"
    fi
  else
    echo "‚ÑπÔ∏è  –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —É—Å—Ç–∞–Ω–æ–≤–∫—É –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π. –í–æ–∑–º–æ–∂–Ω–æ, –∑–∞–ø—É—Å–∫ –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è –æ—à–∏–±–∫–æ–π."
  fi
fi

# –ó–∞–ø—É—Å–∫–∞–µ–º —á–∞—Ç, –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞—è –∞—Ä–≥—É–º–µ–Ω—Ç—ã
python3 chat.py "$@"
